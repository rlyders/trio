8500 REM
8510 REM menus
8520 Y1=B1+1:X1=L2+16:A=7:B=0:C=14:D=1
8530 REM O$=Text:O$()=Options 1-5:O=# of options:a=foreground color:b=background color:c=highlighting color:d=background highlight color:x1=center x pos:y1=verticle pos:aa=current option #
8540 DEF SEG=0:POKE 1050,PEEK(1052):AA=1
8550 XX=LEN(O$):FOR F=1 TO O:XX=XX+LEN(O$(F))+3:NEXT F:XX=X1-INT((XX-3)/2)
8560 COLOR A,B:LOCATE Y1,XX:PRINT O$+"[";:FOR AA=1 TO O-1:GOSUB 8740:PRINT O$(AA)+" | ";:NEXT:GOSUB 8740:PRINT O$(O)+"]";:AA=1
8570 XXX=XX+LEN(O$)+1:LOCATE Y1,XXX:FOR F=1 TO O:IF AA=F THEN COLOR C,D:PRINT OO$(F); ELSE IF OO(F) THEN COLOR ZZ,B:PRINT O$(F) ELSE COLOR A,B:PRINT O$(F);
8580 XXX=XXX+LEN(O$(F))+3:LOCATE Y1,XXX:NEXT
8590 A$=INKEY$:ON LEN(A$)+1 GOTO 8590,8600,8630
8600 IF A$=CHR$(13) THEN 8710
8610 IF A$=CHR$(27) THEN AA=0:GOTO 8710
8620 FOR F=1 TO O:IF ASC(A$)=ASC(O$(F)) OR ASC(A$)=ASC(OO$(F)) THEN AA=F:GOTO 8710 ELSE NEXT:GOTO 8590
8630 A$=RIGHT$(A$,1):IF A$<>CHR$(77) THEN  8660
8640 IF AA=O THEN AA=1 ELSE AA=AA+1
8650 IF OO(AA) THEN 8640 ELSE 8570
8660 IF A$<>CHR$(75) THEN 8690
8670 IF AA=1 THEN AA=O ELSE AA=AA-1
8680 IF OO(AA) THEN 8670 ELSE 8570
8690 IF ASC(A$)=>120 AND ASC(A$)<=129 THEN WW=(ASC(A$)-120):GOTO 8590
8700 IF A$=CHR$(79) THEN GOSUB <<SAVE GAME PRINT>>:IF ED THEN END ELSE 10 ELSE 8590
8710 XXX=XX+LEN(O$)+1:LOCATE Y1,XXX:FOR F=1 TO O:IF AA=F THEN COLOR C,D:PRINT OO$(F); ELSE IF OO(F) THEN COLOR ZZ,B:PRINT O$(F) ELSE COLOR A,B:PRINT O$(F);
8720 XXX=XXX+LEN(O$(F))+3:LOCATE Y1,XXX:NEXT
8730 FOR F=1 TO O:O$(F)="":OO(F)=0:NEXT:O$="":RETURN
8740 REM
8750 REM Capitalizing
8760 OO$(AA)=O$(AA):OO=LEN(OO$(AA)):FOR F=1 TO OO:A$=RIGHT$(OO$(AA),F):IF ASC(A$)=>97 AND ASC(A$)<=122 THEN OO$(AA)=LEFT$(OO$(AA),(OO-F))+CHR$(ASC(A$)-32)+RIGHT$(A$,F-1)
8770 NEXT:RETURN
